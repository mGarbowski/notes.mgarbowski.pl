<!doctype html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>01-podstawy-sieci</title>
    <link rel="stylesheet" href="../style.css">

    <!--    Load mathjax from cdn to render latex equations-->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<div class="prev-next-links">
    
    <div class="index-links-prev">
        <a href="00-organizacja.html">Poprzedni: 00-organizacja.html</a>
    </div>
    

    
    <div class="index-links-next">
        <a href="wyklad-02.html">Następny: wyklad-02.html</a>
    </div>
    
    <div class="return-link">
        <a href="..">Powrót</a>
    </div>
</div>
<div class="container">
    <div class="index-links-wrapper">
        <h2>Programowanie sieciowe</h2>
        <div class="index-links">
            <ul>
                
                <li><a href="00-organizacja.html">00-organizacja.html</a></li>
                
                <li><a href="01-podstawy-sieci.html">01-podstawy-sieci.html</a></li>
                
                <li><a href="wyklad-02.html">wyklad-02.html</a></li>
                
                <li><a href="wyklad-03.html">wyklad-03.html</a></li>
                
                <li><a href="wyklad-04.html">wyklad-04.html</a></li>
                
                <li><a href="wyklad-05.html">wyklad-05.html</a></li>
                
                <li><a href="wyklad-06.html">wyklad-06.html</a></li>
                
            </ul>
        </div>
    </div>
    <div class="content-wrapper">
        <main>
            <h1 id="podstawy-sieci">Podstawy sieci</h1>
<h2 id="sieć">Sieć</h2>
<ul>
<li>Sieć - system komunikacyjny łączący węzły (hosty)</li>
<li>Intersieć - sieć hierarchiczna - sieć łącząca sieci</li>
<li>Internet - intersieć o światowym zasięgu bazująca na standardowych
protokołach rodziny TCP/IP
<ul>
<li>i protokołach stowarzyszonych, protokołach wyższego poziomu</li>
<li>ICMP, ARP, DNS, SNMP, SMTP, FTP, HTTP, LDAP, telnet</li>
</ul></li>
</ul>
<p>TCP/IP - akronim na zestaw standardowych protokołów</p>
<p>AS - system autonomiczny Autonomiczna sieć, która istnieje z punktu
widzenia publicznego routingu</p>
<h2 id="przykładowy-program">Przykładowy program</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode go"><code class="sourceCode go"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">// simple TCP server (c) Grzegorz Blinowski for PSI 2023</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">package</span> main</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="op">(</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;flag&quot;</span> <span class="co">// command line parsing</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fmt&quot;</span>  <span class="co">// printing</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;net&quot;</span>  <span class="co">// sockets</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;time&quot;</span> <span class="co">// clock time</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> <span class="op">(</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    SERVER_HOST <span class="op">=</span> <span class="st">&quot;localhost&quot;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    SERVER_PORT <span class="op">=</span> <span class="st">&quot;8001&quot;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    PROTO       <span class="op">=</span> <span class="st">&quot;tcp&quot;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> <span class="op">(</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    NET_BUF_SZ <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="kw">func</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Command line parsing: -host &lt;host-address&gt; -port &lt;port-numer&gt;</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    HostargPtr <span class="op">:=</span> flag<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;host&quot;</span><span class="op">,</span> SERVER_HOST<span class="op">,</span> <span class="st">&quot;Host to connect to&quot;</span><span class="op">)</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    PortargPtr <span class="op">:=</span> flag<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;port&quot;</span><span class="op">,</span> SERVER_PORT<span class="op">,</span> <span class="st">&quot;Port to connect to&quot;</span><span class="op">)</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    flag<span class="op">.</span>Parse<span class="op">()</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    server_socket<span class="op">,</span> err <span class="op">:=</span> net<span class="op">.</span>Listen<span class="op">(</span>PROTO<span class="op">,</span> <span class="op">*</span>HostargPtr<span class="op">+</span><span class="st">&quot;:&quot;</span><span class="op">+*</span>PortargPtr<span class="op">)</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> err <span class="op">!=</span> <span class="ot">nil</span> <span class="op">{</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">panic</span><span class="op">(</span>err<span class="op">)</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">defer</span> server_socket<span class="op">.</span>Close<span class="op">()</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    fmt<span class="op">.</span>Println<span class="op">(</span><span class="st">&quot;waiting for client...&quot;</span><span class="op">)</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">{</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        client_socket<span class="op">,</span> err <span class="op">:=</span> server_socket<span class="op">.</span>Accept<span class="op">()</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> err <span class="op">!=</span> <span class="ot">nil</span> <span class="op">{</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>            <span class="bu">panic</span><span class="op">(</span>err<span class="op">)</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        fmt<span class="op">.</span>Println<span class="op">(</span><span class="st">&quot;Client connection accepted.&quot;</span><span class="op">)</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>        <span class="co">// concurrent server -serves multiple clients with go routine</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">go</span> <span class="kw">func</span><span class="op">(</span>csocket net<span class="op">.</span>Conn<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>            buffer <span class="op">:=</span> <span class="bu">make</span><span class="op">([]</span><span class="dt">byte</span><span class="op">,</span> NET_BUF_SZ<span class="op">)</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>            msgLen<span class="op">,</span> err <span class="op">:=</span> csocket<span class="op">.</span>Read<span class="op">(</span>buffer<span class="op">)</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> err <span class="op">!=</span> <span class="ot">nil</span> <span class="op">{</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>                <span class="bu">panic</span><span class="op">(</span>err<span class="op">)</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>            fmt<span class="op">.</span>Printf<span class="op">(</span><span class="st">&quot;Received %d bytes from socket, data=[%s]</span><span class="ch">\n</span><span class="st">&quot;</span><span class="op">,</span> msgLen<span class="op">,</span> <span class="dt">string</span><span class="op">(</span>buffer<span class="op">[:</span>msgLen<span class="op">]))</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>            _<span class="op">,</span> err <span class="op">=</span> csocket<span class="op">.</span>Write<span class="op">([]</span><span class="dt">byte</span><span class="op">(</span><span class="st">&quot;ACK, resending your data with timestamp: &quot;</span> <span class="op">+</span> time<span class="op">.</span>Now<span class="op">().</span>Format<span class="op">(</span>time<span class="op">.</span>UnixDate<span class="op">)</span> <span class="op">+</span> <span class="st">&quot; &quot;</span> <span class="op">+</span> <span class="dt">string</span><span class="op">(</span>buffer<span class="op">[:</span>msgLen<span class="op">])))</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> err <span class="op">!=</span> <span class="ot">nil</span> <span class="op">{</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>                <span class="bu">panic</span><span class="op">(</span>err<span class="op">)</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>            csocket<span class="op">.</span>Close<span class="op">()</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>        <span class="op">}(</span>client_socket<span class="op">)</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<ul>
<li>Adresowanie
<ul>
<li>adresy sieciowe (IP) lub symboliczne (DNS)</li>
<li>porty sieciowe</li>
</ul></li>
<li>Sekwencja poleceń prowadząca do zainicjowania gniazda i
<em>zestawienia łączności</em>
<ul>
<li>wykorzystanie funkcji gniazd</li>
</ul></li>
<li>Przesyłanie danych
<ul>
<li>niezawodność (dla TCP)</li>
<li>wielkość <em>porcji</em> przesłanych danych (organizacja transmisji
i wydajność)</li>
<li>reprezentacja danych - dane mogą być różnie reprezentowane na
różnych komputerach, różne wyrównanie pól struktury</li>
</ul></li>
</ul>
<h2 id="stos-sieciowy">Stos sieciowy</h2>
<ul>
<li>Warstwowa abstrakcja sieci komputerowych jako sposób na pogodzenie
niezgodności sprzętowo-programowych</li>
<li>Warstwa definiowana poprzez interfejsy (sprzętowe i programowe)</li>
<li>W idealnym przypadku każda warstwa może podlegać reimplementacji bez
naruszania pozostałych</li>
<li>W sensie abstrakcyjnym komunikacja następuje na poziomie
<ul>
<li>warstwa hosta - odpowiadająca warstwa hosta</li>
<li>np. warstwa sieciowa komunikuje się z warstwą sieciową na drugiej
maszynie</li>
</ul></li>
<li>Przykład - stos ISO/OSI odpowiada oprogramowaniu
<ul>
<li><ol start="7" type="1">
<li>aplikacyjnemu</li>
</ol></li>
<li>(6, 5) bibliotecznemu</li>
<li>(4, 3) systemowemu</li>
<li>(2, 1) zlokalizowanemu bezpośrednio na sprzęcie</li>
</ul></li>
</ul>
<h3 id="stos-isoosi">Stos ISO/OSI</h3>
<ul>
<li>7 - aplikacji</li>
<li>6 - prezentacji</li>
<li>5 - zastosowań</li>
<li>4 - transportu</li>
<li>3 - sieciowa</li>
<li>2 - kanałowa</li>
<li>1 - fizyczna</li>
</ul>
<h3 id="stos-sieciowy-na-nasze-potrzeby">Stos sieciowy na nasze
potrzeby</h3>
<ul>
<li>Procesu
<ul>
<li>warstwy 5, 6, 7 ISO/OSI</li>
<li>np. WWW, FTP, SMTP</li>
<li>komunikaty</li>
</ul></li>
<li>Transportu
<ul>
<li>warstwa 4 ISO/OSI</li>
<li>TCP, UDP</li>
<li>komunikaty / segmenty</li>
</ul></li>
<li>Sieciowa
<ul>
<li>warstwa 3 ISO/OSI</li>
<li>IP</li>
<li>pakiety</li>
</ul></li>
<li>Kanałowa
<ul>
<li>warstwy 1, 2 ISO/OSI</li>
<li>Ethernet, Wi-Fi</li>
<li>ramki, bity</li>
</ul></li>
</ul>
<h2
id="zwielokrotnienie-i-rozdzielenie-danych-w-stosie-isoosi">Zwielokrotnienie
i rozdzielenie danych w stosie ISO/OSI</h2>
<ul>
<li>Komputer może mieć wiele interfejsów
<ul>
<li>np. ethernet i WiFi</li>
</ul></li>
<li>Komputer może korzystać jednocześnie z oddzielnych stosów IPv4 i
IPv6</li>
<li>Oba stsoy mogą korzystać z tego samego interfejsu sieciowego</li>
<li>Jeden proces może korzystać z obu stosów na raz</li>
<li>Dane przechodzą przez kolejne warstwy</li>
</ul>
<h3 id="opakowanie-nagłówków">Opakowanie nagłówków</h3>
<ul>
<li>Zwielokrotnianie i rozdzielanie danych musi odbywać się na podstawie
dodatkowej informacji
<ul>
<li>niezależnej od samych danych</li>
</ul></li>
<li>Każda warstwa oprogramowania sieciowego dokłada własny nagłówek
<ul>
<li>powstaje szereg enkapsulowanych nagłówków</li>
</ul></li>
<li>Przy odbiorze danych proces jest odwracany następuje dekapsulacja
nagłówków
<ul>
<li>kolejne nagłówki są zdejmowane przez kolejne warstwy</li>
</ul></li>
<li>Na każdą porcję danych przypada pewien narzut związany z nagłówkami
<ul>
<li>trzeba brać to pod uwagę projektując protokół</li>
</ul></li>
<li>Przykładowo, po wysłaniu porcji danych otrzymujemy
<ul>
<li>nagłówek Ethernet</li>
<li>nagłówek IP</li>
<li>nagłówek UDP</li>
<li>dane</li>
<li>Ethernes FCS - na końcu!</li>
</ul></li>
</ul>
<h2 id="protokoły-datagramowe-i-połączeniowe">Protokoły datagramowe i
połączeniowe</h2>
<ul>
<li>Protokół datagramowy - bezpołączeniowy (connectionless service)</li>
<li>Protokół połączeniowy (connection oriented service)</li>
<li>Cechy obu
<ul>
<li>kontrola poprawności</li>
<li>sekwencyjność</li>
<li>niezawodność - kontrola poprawności i sekwencyjność</li>
<li>transmisja simplex lub full/half duplex</li>
</ul></li>
</ul>
<h3 id="protokół-datagramowy">Protokół datagramowy</h3>
<ul>
<li>Metoda stosowana w sieciach komputerowych</li>
<li>Nadawca i odbiorca</li>
<li>Dane podzielone na datagramy</li>
<li>Podróżuje przez sieć, ścieżka ustalona dynamicznie, oddzielnie dla
każdego pakietu</li>
<li>Każdy pakiet podróżuje niezależnie</li>
<li>O dalszym losie pakietu decyduje ruter</li>
<li>Ruter nie utrzymuje informacji o połączeniach
<ul>
<li>nierealne zapotrzebowanie na pamięć</li>
</ul></li>
<li>Droga może być za każdym razem inna
<ul>
<li>datagramy mogą ginąć</li>
<li>datagramy mogą przychodzić w zmienionej kolejności</li>
<li>datagramy mogą ulec zwielokrotnieniu</li>
</ul></li>
</ul>
<h3 id="protokół-połączeniowy">Protokół połączeniowy</h3>
<ul>
<li>Stosowana w sieciach telefonicznych</li>
<li>Nadawca i odbiorca</li>
<li>Komunikacja w fazach
<ul>
<li>zestawienie połączenia (obwodu)</li>
<li>wymiana informacji</li>
<li>rozłączenie</li>
</ul></li>
<li>Historycznie - zestawianie fizycznych połączeń</li>
<li>Obecnie - wirtualne połączenia realizowane na protokołach
datagramowych</li>
</ul>
<h3 id="dlaczego-protokół-datagramowy">Dlaczego protokół
datagramowy</h3>
<ul>
<li>Założenia
<ul>
<li>łącza są kosztowne</li>
<li>ruch jest nieregularny, charakteryzuje się gwałtownymi skokami
natężenia</li>
<li>sieć ma być niezawodna - odporna na awarię / zniszczenie pewnej
liczby węzłów</li>
</ul></li>
<li>Wiele źródeł danych nadaje z maksymalną prędkością <span
class="math inline">\(R\)</span></li>
<li>Dane trafiają do bufora, z którego są transmitowane z maksymalną
prędkością <span class="math inline">\(R\)</span></li>
<li>Bufor absorbuje krótkotrwałe skoki natężenia ruchu pakietów - łącze
nie musi mieć przepustowości <span class="math inline">\(n \cdot
R\)</span></li>
<li>Bufor ma ograniczony rozmiar, przy dłużej trwających skokach
natężenia, pakiety będą ginąć</li>
<li>Multipleksowanie, buforowanie, odrzucanie nadmiaru
<ul>
<li>ogranicza koszty</li>
</ul></li>
</ul>

        </main>
    </div>
    <div class="table-of-contents">
        <nav id="TOC" role="doc-toc">
<ul>
<li><a href="#podstawy-sieci" id="toc-podstawy-sieci">Podstawy sieci</a>
<ul>
<li><a href="#sieć" id="toc-sieć">Sieć</a></li>
<li><a href="#przykładowy-program" id="toc-przykładowy-program">Przykładowy program</a></li>
<li><a href="#stos-sieciowy" id="toc-stos-sieciowy">Stos sieciowy</a>
<ul>
<li><a href="#stos-isoosi" id="toc-stos-isoosi">Stos ISO/OSI</a></li>
<li><a href="#stos-sieciowy-na-nasze-potrzeby" id="toc-stos-sieciowy-na-nasze-potrzeby">Stos sieciowy na nasze
potrzeby</a></li>
</ul></li>
<li><a href="#zwielokrotnienie-i-rozdzielenie-danych-w-stosie-isoosi" id="toc-zwielokrotnienie-i-rozdzielenie-danych-w-stosie-isoosi">Zwielokrotnienie
i rozdzielenie danych w stosie ISO/OSI</a>
<ul>
<li><a href="#opakowanie-nagłówków" id="toc-opakowanie-nagłówków">Opakowanie nagłówków</a></li>
</ul></li>
<li><a href="#protokoły-datagramowe-i-połączeniowe" id="toc-protokoły-datagramowe-i-połączeniowe">Protokoły datagramowe i
połączeniowe</a>
<ul>
<li><a href="#protokół-datagramowy" id="toc-protokół-datagramowy">Protokół datagramowy</a></li>
<li><a href="#protokół-połączeniowy" id="toc-protokół-połączeniowy">Protokół połączeniowy</a></li>
<li><a href="#dlaczego-protokół-datagramowy" id="toc-dlaczego-protokół-datagramowy">Dlaczego protokół
datagramowy</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>
</body>
</html>